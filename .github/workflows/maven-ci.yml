name: Frontend CI/CD Deploy

on:
  push:
    branches: [ "main" ]

jobs:
  deploy-frontend:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ§© Checkout cÃ³digo
        uses: actions/checkout@v4

      - name: ðŸŽ¨ Desplegar Frontend en VM
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.GCP_VM_IP }}
          username: ${{ secrets.GCP_USER }}
          key: ${{ secrets.GCP_SSH_KEY }}
          script: |
            echo "ðŸš€ Desplegando frontend en producciÃ³n..."
            cd ~/athenia-clean/athenia-frontend
            npm install --legacy-peer-deps
            npm run build
            sudo rm -rf /var/www/html/*
            sudo cp -r dist/* /var/www/html/
            sudo systemctl restart nginx
            echo "âœ… Frontend desplegado correctamente."
